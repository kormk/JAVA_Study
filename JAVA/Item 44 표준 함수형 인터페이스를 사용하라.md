# Item 44. ν‘μ¤€ ν•¨μν• μΈν„°νμ΄μ¤λ¥Ό μ‚¬μ©ν•λΌ.

### λ“¤μ–΄κ°€λ©°

μλ°”κ°€ λλ‹¤λ¥Ό μ§€μ›ν•λ©΄μ„ APIλ¥Ό μ‘μ„±ν•λ” λ¨λ²” μ‚¬λ΅€λ„ ν¬κ² λ°”λ€μ—λ‹¤.

μμ»¨λ° μƒμ„ ν΄λμ¤μ κΈ°λ³Έ λ©”μ„λ“λ¥Ό μ¬μ •μν•΄ μ›ν•λ” λ™μ‘μ„ κµ¬ν„ν•λ” νƒ¬ν”λ¦Ώ λ©”μ„λ“ ν¨ν„΄μ λ§¤λ ¥μ΄ ν¬κ² μ¤„μ—λ‹¤.

μ΄λ¥Ό λ€μ²ν•λ” ν„λ€μ μΈ ν•΄λ²•μ€ κ°™μ€ ν¨κ³Όμ ν•¨μ κ°μ²΄λ¥Ό λ°›λ” μ •μ  ν©ν„°λ¦¬λ‚ μƒμ„±μλ¥Ό μ κ³µν•λ” κ²ƒμ΄λ‹¤.

β‡’ μ΄ λ‚΄μ©μ„ μΌλ°ν™” ν•λ©΄ ν•¨μ κ°μ²΄λ¥Ό λ§¤κ°λ³€μλ΅ λ°›λ” μƒμ„±μμ™€ λ©”μ„λ“λ¥Ό λ” λ§μ΄ λ§λ“¤μ–΄μ•Όν•λ‹¤.(μ΄λ• ν•¨μν• λ§¤κ°λ³€μ νƒ€μ…μ„ μ¬λ°”λ¥΄κ² μ„ νƒν•΄μ•Ό ν•λ‹¤.)


<br/>

## λ³Έλ¬Έ

> LinkedHahsMap μμ‹: removeEldestEntry μ¬μ •μ
> 

μ•„λμ μ½”λ“μ™€ κ°™μ΄ removeEldestEntryλ¥Ό μ¬μ •μ ν•λ©΄ λ§µμ— μ›μ†κ°€ 100κ°κ°€ λ  λ•κΉμ§€ μ»¤μ§€λ‹¤κ°€ κ·Έ μ΄μƒμ΄ λλ©΄ μƒλ΅μ΄ ν‚¤κ°€ λ”ν•΄μ§ λ•λ§λ‹¤ κ°€μ¥ μ¤λλ μ›μ†λ¥Ό ν•λ‚μ”© μ κ±°ν•λ‹¤. μ¦‰ κ°€μ¥ μµκ·Ό μ›μ† 100κ°λ¥Ό μ μ§€ν•λ‹¤.

```java
protected boolean removeEldestEntry(Map.Entry<K,V> eldest){
	return size() > 100;
}
```

LinkedHahsMapμ„ μ¤λλ‚  λ‹¤μ‹ κµ¬ν„ν•λ‹¤λ©΄ ν•¨μ κ°μ²΄λ¥Ό λ°›λ” μ •μ  ν©ν„°λ¦¬λ‚ μƒμ„±μλ¥Ό μ κ³µν–μ„ κ²ƒμ΄λ‹¤.  
removeEldestEntry μ„ μ–Έμ„ λ³΄λ©΄ μ΄ ν•¨μ κ°μ²΄λ” Map.Entry<K,V>λ¥Ό λ°›μ•„ booleanμ„ λ°ν™ ν•΄μ•Όν•  κ²ƒ κ°™μ§€λ§ κΌ­ κ·Έλ ‡μ§€λ§μ€ μ•λ‹¤.  
removeEldestEntryκ°€ μΈμ¤ν„΄μ¤ λ©”μ„λ“λΌμ„ κ°€λ¥ν• λ°©μ‹μ΄λ‹¤. ν•μ§€λ§ ν•¨μ κ°μ²΄λ” μ΄ λ§µμ μΈμ¤ν„΄μ¤ λ©”μ†λ“λΌμ„ κ°€λ¥ν• λ°©μ‹μ΄λ‹¤. 

ν•μ§€λ§ μƒμ„±μμ— λ„κΈ°λ” ν•¨μ κ°μ²΄λ” μ΄ λ§µμ μΈμ¤ν„΄μ¤ λ©”μ„λ“κ°€ μ•„λ‹λ‹¤. ν©ν„°λ¦¬λ‚ μƒμ„±μλ¥Ό νΈμ¶ν•  λ•λ” λ§µμ μΈμ¤ν„΄μ¤κ°€ μ΅΄μ¬ν•μ§€ μ•κΈ° λ•λ¬Έμ΄λ‹¤. 

λ”°λΌμ„ λ§µμ€ μκΈ° μμ‹ λ„ ν•¨μ κ°μ²΄μ— κ±΄λ‚΄μ¤μ•Όν•λ‹¤.

<br/>

μ΄λ¥Ό λ°μν• ν•¨μν• μΈν„°νμ΄μ¤λ” λ‹¤μμ²λΌ μ„ μ–Έν•  μμλ‹¤.

> λ¶ν•„μ”ν• ν•¨μν• μΈν„°νμ΄μ¤
> 

```java
@FunctionalInteface 
interface EldestEntryRemovalFunction<K,V>{
	boolean remove(Map<K,V> map, Map.Entry<K,V> eldest);
}
```

μ΄ μΈν„°νμ΄μ¤λ„ μ λ™μ‘ν•κΈ°λ” ν•μ§€λ§ κµ³μ΄ μ‚¬μ©ν•  μ΄μ λ” μ—†λ‹¤. μλ°” ν‘μ¤€ λΌμ΄λΈλ¬λ¦¬μ— μ΄λ―Έ κ°™μ€ λ¨μ–‘μ μΈν„°νμ΄μ¤κ°€ μ¤€λΉ„λμ–΄ μκΈ° λ•λ¬Έμ΄λ‹¤. java.util.function ν¨ν‚¤μ§€λ¥Ό λ³΄λ©΄ λ‹¤μ–‘ν• μ©λ„μ ν‘μ¤€ν• μΈν„°νμ΄μ¤κ°€ λ‹΄κ²¨μλ‹¤.

π“Β ν•„μ”ν• μ©λ„μ— λ§λ” κ² μλ‹¤λ©΄, μ§μ ‘ κµ¬ν„ν•μ§€λ§κ³  ν‘μ¤€ ν•¨μν• μΈν„°νμ΄μ¤λ¥Ό ν™μ©ν•λΌ

π“Β APIκ°€ λ‹¤λ£¨λ” κ°λ…μ μκ°€ μ¤„μ–΄λ“¤μ–΄ μµνκΈ° μ‰¬μ›μ§„λ‹¤.

π“Β ν‘μ¤€ ν•¨μν• μΈν„°νμ΄μ¤λ“¤μ€ μ μ©ν• λ””ν΄νΈ λ©”μ„λ“λ¥Ό λ§μ΄ μ κ³µν•λ―€λ΅ λ‹¤λ¥Έ μ½”λ“μ™€ μƒνΈ μ΄μ©μ„±μ΄ μΆ‹μ•„μ§„λ‹¤.

> Predicate μΈν„°νμ΄μ¤λ¥Ό μ‚¬μ©ν•΄ EldestEntryRemovalFunction λ€μ‹ ν•κΈ°
> 

<br/>

<h2> κΈ°λ³Έ μΈν„°νμ΄μ¤ </h2>

`java.util.function` ν¨ν‚¤μ§€μ—λ” μ΄ 43κ°μ μΈν„°νμ΄μ¤κ°€ λ‹΄κ²¨μλ‹¤.

κΈ°λ³Έ μΈν„°νμ΄μ¤ 6κ°λ§ κΈ°μ–µν•λ©΄ λ‚λ¨Έμ§€λ” μ¶©λ¶„ν μ μ¶”ν•΄λ‚Ό μ μλ‹¤.  μ΄ κΈ°λ³Έ μΈν„°νμ΄μ¤λ“¤μ€ λ¨λ‘ μ°Έμ΅° νƒ€μ…μ©μ΄λ‹¤. 

| μΈν„°νμ΄μ¤ | ν•¨μ μ‹κ·Έλ‹μ² | μ |
| --- | --- | --- |
| `UnaryOperator<T>` | T apply(T t) | String::toLowerCase |
| `BinaryOperator<T>` | T apply(T t1, T t2) | BigInteger::add |
| `Predicate<T>` | boolean test(T t) | Collection::isEmpty |
| `Function<T, R>` | R apply(T t) | Arrays::asList |
| `Supplier<T>` | T get() | Instant::now |
| `Consumer<T>` | void accept(T t) | System.out::println |

<br/>

>Operator μΈν„°νμ΄μ¤ 

μΈμκ°€ 1κ°μΈ unaryOperatorμ™€ μΈμκ°€ 2κ°μΈ BinaryOperatorλ΅ λ‚λ‰λ©° λ°ν™κ°’κ³Ό μΈμμ νƒ€μ…μ΄ κ°™μ€ ν•¨μλ¥Ό λ»ν•λ‹¤.

> Predicate μΈν„°νμ΄μ¤

μΈμ ν•λ‚λ¥Ό λ°›μ•„ booleanμ„ λ°ν™ν•λ” ν•¨μλ¥Ό λ»ν•λ‹¤.

>Function μΈν„°νμ΄μ¤

μΈμμ™€ λ°ν™ νƒ€μ…μ΄ λ‹¤λ¥Έ ν•¨μλ¥Ό λ»ν•λ‹¤.

>Supplier μΈν„°νμ΄μ¤

μΈμλ¥Ό λ°›μ§€ μ•κ³  κ°’μ„ λ°ν™(νΉμ€ μ κ³µ)ν•΄μ£Όλ” ν•¨μλ¥Ό λ»ν•λ‹¤.

>Consume μΈν„°νμ΄μ¤

<br/>

μΈμλ¥Ό ν•λ‚ λ°›κ³  λ°ν™κ°’μ€ μ—†λ”(νΉν μΈμλ¥Ό μ†λΉ„ν•λ”) ν•¨μλ¥Ό λ»ν•λ‹¤.

π“Β κΈ°λ³Έ μΈν„°νμ΄μ¤λ” κΈ°λ³Έ νƒ€μ…μΈ `int`, `long`, `double`μ©μΌλ΅ κ° 3κ°μ‹ λ³€ν•μ΄ μƒκ²¨λ‚λ‹¤.

<br/>

ν‘μ¤€ ν•¨μν• μΈν„°νμ΄μ¤ λ€λ¶€λ¶„μ€ κΈ°λ³Έ νƒ€μ…λ§ μ§€μ›ν•λ‹¤. κ·Έλ ‡λ‹¤κ³  κΈ°λ³Έ ν•¨μν• μΈν„°νμ΄μ¤μ— λ°•μ‹±λ κΈ°λ³Έ νƒ€μ…μ„ λ„£μ–΄ μ‚¬μ©ν•μ§€λ” λ§μ. λ™μ‘μ€ ν•μ§€λ§ κ³„μ‚°λ‰μ΄ λ§μ„ λ•λ” μ„±λ¥μ΄ μ²μ°Έν•κ² λλ ¤μ§ μ μλ‹¤.

μ½”λ“λ¥Ό μ§μ ‘ μ‘μ„±ν•΄μ•Ό ν•λ” κ²½μ°λ” ν‘μ¤€ μΈν„°νμ΄μ¤ μ¤‘ ν•„μ”ν• μ©λ„μ— λ§λ”κ² μ—†λ” κ²½μ° μ§μ ‘ μ‘μ„±ν•λ‹¤.

<br/>

> `Comparator`κ°€ λ…μμ μΈ μΈν„°νμ΄μ¤λ΅ μ‚΄μ•„ λ‚¨μ•„μ•Ό ν•λ” μ΄μ 
> 
1. APIμ—μ„ κµ‰μ¥ν μμ£Ό μ‚¬μ©λλ”λ° μ§€κΈμ μ΄λ¦„μ΄ κ·Έ μ©λ„λ¥Ό μ•„μ£Ό ν›λ¥­ν μ„¤λ…ν•΄μ¤€λ‹¤.
2. κµ¬ν„ν•λ” μ½μ—μ„ λ°λ“μ‹ μ§€μΌμ•Ό ν•  κ·μ•½μ„ λ‹΄κ³ μλ‹¤.
3. λΉ„κµμλ“¤μ„ λ³€ν™ν•κ³  μ΅°ν•©ν•΄μ£Όλ” μ μ©ν• λ””ν΄νΈ λ©”μ„λ“λ¥Ό λ“¬λΏ λ‹΄κ³ μλ‹¤.

μ΄μƒμ ComparatorνΉμ„±μ„ μ •λ¦¬ν•λ©΄ λ‹¤μμ μ„Έ κ°€μ§€μΈλ°, μ΄ μ¤‘ ν•λ‚ μ΄μƒμ„ λ§μ΅±ν•λ‹¤λ©΄ μ „μ© ν•¨μν• μΈν„°νμ΄μ¤λ¥Ό κµ¬ν„ν•΄μ•Ό ν•λ” κ±΄ μ•„λ‹μ§€ μ§„μ¤‘ν•κ² κ³ λ―Όν•΄μ•Όν•λ‹¤.

- μμ£Ό μ“°μ΄λ©°, μ΄λ¦„ μμ²΄κ°€ μ©λ„λ¥Ό μ •ν™•ν•κ² μ„¤λ…ν•΄μ¤€λ‹¤.
- λ°λ“μ‹ λ”°λΌμ•Όν•λ” κ·μ•½μ΄ μλ‹¤.
- μ μ©ν• λ””ν΄νΈ λ©”μ„λ“λ¥Ό μ κ³µν•  μ μλ‹¤.

μ „μ© ν•¨μν• μΈν„°νμ΄μ¤λ¥Ό μ‘μ„±ν•κΈ°λ΅ ν–λ‹¤λ©΄, μμ‹ μ΄ μ‘μ„±ν•΄μ•Όν•λ” κ² λ‹¤λ¥Έ κ²ƒλ„ μ•„λ‹ μΈν„°νμ΄μ¤μ„μ„ λ…μ‹¬ν•΄μ•Όν•λ‹¤, μ•„μ£Ό μ£Όμν•΄μ„ μ„¤κ³„ ν•΄μ•Όν•λ‹¤λ” λ»μ΄λ‹¤.

<br/>

> `@FunctionalInterface` μ• λ„ν…μ΄μ…
> 

μ΄ μ• λ„ν…μ΄μ…μ„μ‚¬μ©ν•λ” μ΄μ λ” `@Override`λ¥Ό μ‚¬μ©ν•λ” μ΄μ μ™€ λΉ„μ·ν•λ‹¤.

κ°λ°μμ μλ„λ¥Ό λ…μ‹ν•λ” κ²ƒμΌλ΅ ν¬κ² 3κ°€μ§€μ λ©μ μ΄ μλ‹¤.

1. ν•΄λ‹Ή ν΄λμ¤μ μ½”λ“λ‚ μ„¤λ… λ¬Έμ„λ¥Ό μ½μ„ μ΄μ—κ² κ·Έ μΈν„°νμ΄μ¤κ°€ λλ‹¤μ©μΌλ΅ μ„¤κ³„λ κ²ƒμ„μ„ μ•λ ¤μ¤€λ‹¤.
2. ν•΄λ‹Ή μΈν„°νμ΄μ¤κ°€ μ¶”μƒλ©”μ„λ“λ¥Ό μ¤μ§ ν•λ‚λ§ κ°€μ§€κ³  μμ–΄μ•Ό μ»΄νμΌ λκ² ν•΄μ¤€λ‹¤.
3. κ·Έ κ²°κ³Ό μ μ§€λ³΄μ κ³Όμ •μ—μ„ λ„κµ°κ°€ μ‹¤μλ΅ λ©”μ„λ“λ¥Ό μ¶”κ°€ν•μ§€ λ»ν•κ² λ§‰μ•„μ¤€λ‹¤.

β‡’ κ·Έλ¬λ‹ μ§μ ‘λ§λ“  ν•¨μν• μΈν„°νμ΄μ¤μ—λ” ν•­μƒ `@FunctionalInterface` μ• λ„ν…μ΄μ…μ„ μ‚¬μ©ν•λΌ.

<br/>


> ν•¨μν• μΈν„°νμ΄μ¤λ¥Ό APIμ—μ„ μ‚¬μ©ν•  λ•μ μ£Όμμ 
> 

μ„λ΅ λ‹¤λ¥Έ ν•¨μν• μΈν„°νμ΄μ¤λ¥Ό κ°™μ€ μ„μΉμ μΈμλ΅ λ°›λ” λ©”μ„λ“λ“¤μ„ λ‹¤μ¤‘μΌλ΅ μ •μν•΄μ„λ” μ•λλ‹¤.